<!DOCTYPE html>
<html lang="zxx">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="refresh" content="">
  <meta name="description" content="member_reservation" />
  <meta name="keywords" content="Cake, unica, creative, html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Restaurant | AdOrders</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800;900&display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet" />

  <!-- Css Styles -->
  <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="css/flaticon.css" type="text/css" />
  <link rel="stylesheet" href="css/barfiller.css" type="text/css" />
  <link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />
  <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="css/elegant-icons.css" type="text/css" />
  <link rel="stylesheet" href="css/nice-select.css" type="text/css" />
  <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" />
  <link rel="stylesheet" href="css/slicknav.min.css" type="text/css" />
  <link rel="stylesheet" href="css/style.css" type="text/css" />
  <link rel="stylesheet" href="css/fontawesome_6.2.0.css" type="text/css" />
  <!-- <link rel="stylesheet" href="css/reservation.css" type="text/css" /> -->
  <link rel="stylesheet" href="css/member_page_overview.css" type="text/css" />
  <!-- <link rel="stylesheet" href="css/alice_style.css" type="text/css" /> -->
</head>
<style>
  .nice-select {
    width: 80%;
  }
</style>

<body>
  <!-- Page Preloder -->
  <div id="preloder">
    <div class="loader"></div>
  </div>

  <!-- Offcanvas Menu Begin -->
  <div class="offcanvas-menu-overlay"></div>
  <div class="offcanvas-menu-wrapper">
    <div class="offcanvas__cart">
      <div class="offcanvas__cart__links">
        <a href="#" class="search-switch"><img src="img/icon/search.png" alt="" /></a>
        <a href="#"><img src="img/icon/heart.png" alt="" /></a>
      </div>
      <div class="offcanvas__cart__item">
        <a href="#"><img src="img/icon/cart.png" alt="" /> <span>0</span></a>
        <div class="cart__price">Cart: <span>$0.00</span></div>
      </div>
    </div>
    <div class="offcanvas__logo">
      <a href="./GoodEatTime.html"><img class="GoodEatTimelogo" src="/img/GoodEatTime_smlogo.png" alt="" /></a>
    </div>
    <div id="mobile-menu-wrap"></div>
    <div class="offcanvas__option">
      <ul>
        <li>
          USD <span class="arrow_carrot-down"></span>
          <ul>
            <li>EUR</li>
            <li>USD</li>
          </ul>
        </li>
        <li>
          ENG <span class="arrow_carrot-down"></span>
          <ul>
            <li>Spanish</li>
            <li>ENG</li>
          </ul>
        </li>
        <li>
          <a href="#">Sign in</a> <span class="arrow_carrot-down"></span>
        </li>
      </ul>
    </div>
  </div>
  <!-- Offcanvas Menu End -->

  <!-- Header Section Begin -->
  <header class="header">
    <div class="header__top">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="header__top__inner">
              <div class="header__top__left">
                <ul>
                  <li>
                    <img class="login_icon" src="./img/Login_icon.png" /><a class="login_text" href="#">登入</a>
                  </li>
                </ul>
              </div>
              <div class="header__logo">
                <a href="./GoodEatTime.html"><img class="goodeattime_logo" src="img/GoodEatTime_logoright.png"
                    alt="" /></a>
              </div>
              <div class="header__top__right">
                <div class="header__top__right__links">
                  <a href="" class="search-switch"><img src="img/icon/search.png" alt="" /></a>
                  <a href="#"><img src="img/icon/heart.png" alt="" /></a>
                </div>
                <div class="header__top__right__cart">
                  <a href="#"><img src="img/icon/cart.png" alt="" /> <span>0</span></a>
                  <div class="cart__price">Cart: <span>$0.00</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="canvas__open"><i class="fa fa-bars"></i></div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <nav class="header__menu mobile-menu">
            <ul>
              <li class="active"><a href="./GoodEatTime.html">首頁</a></li>
              <li><a href="./about.html">會員專區</a></li>
              <li><a href="./shop.html">餐廳</a></li>
              <li><a href="./blog.html">線上商城</a></li>
              <li>
                <a href="#">關於我們</a>
                <ul class="dropdown">
                  <li><a href="./shop-details.html">Shop Details</a></li>
                  <li><a href="./shoping-cart.html">Shoping Cart</a></li>
                  <li><a href="./checkout.html">Check Out</a></li>
                  <li><a href="./wisslist.html">Wisslist</a></li>
                  <li><a href="./Class.html">Class</a></li>
                  <li><a href="./blog-details.html">Blog Details</a></li>
                </ul>
              </li>
              <li><a href="./contact.html">地點搜尋</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- Header Section End -->

  <!-- Class Section Begin -->
  <section class="class">
    <!-- <div class="container"> -->
    <div class="row" id="member">
      <!-- <div class="col-lg-2" id="left"> -->
      <div class="col-lg-2" id="left"">
        <nav class=" header__menu mobile-menu" id="aaa">
        <ul>
          <li class=""><a href="#">餐廳會員首頁</a></li>
          <li class=""><a href="">餐廳資訊</a></li>
          <li class=""><a href="">訂單管理</a></li>
          <li class=""><a href="">訂位管理</a></li>
          <li class=""><a href="">評論管理</a></li>
          <li class=""><a href="">折價券設定</a></li>
          <li class=""><a href="">餐點資料設定</a></li>
          <li class=""><a href="">權限設定</a></li>
          <li class=""><a href="">銷售報表</a></li>
          <li class=""><a href="">購買廣告</a></li>
        </ul>
        </nav>
      </div>
      <div class="col-lg-10" style="background-color:white;height:auto;">
        <div class="row-col-12"
          style="align-items:center; display: grid;justify-content:left;height:10%; margin-top: 20px;margin-left: 5px;">
          <!-- 餐廳身分 -> 看不到審核備註內容、在尚未審核通過前可以修改 "開始日期" 和 "更新圖片" 、 2. boolean為null的問題 -> solution可改成刪除嗎? -->
          <input type="search" class="membership_search" data-table="userNo-table" placeholder="輸入欲查詢之資料"
            style="width: 200px; padding:7px; border-radius: 8px; box-shadow: 5px 5px 2px #FFD382;">
        </div>
        <div class="table-responsive" style="margin-top:20px">
          <table class="userNo-table table" width="100%" style="table-layout:fixed; align-items: center;">
            <!-- <caption>1. 設定可修改狀態，連動到後端update DB<br>2. 綁定click事件更動編輯紐為確認 -> 餐廳僅可修改開始時間和編輯圖片<br>4. 消滅表格第七欄底線</caption> -->
            <thead align="center" valign="center">
              <tr>
                <th align="center" style="border:3px #FFD382 dashed; width:90px">訂單No</th>
                <th align="center" style="border:3px #FFD382 dashed; width:90px">餐廳No</th>
                <th align="center" style="border:3px #FFD382 dashed; width:200px">申請日期</th>
                <th align="center" style="border:3px #FFD382 dashed; width:200px">開始時間</th>
                <th align="center" style="border:3px #FFD382 dashed; width:200px">結束時間</th>
                <th align="center" style="border:3px #FFD382 dashed; width:100px">訂單價格</th>
                <th align="center" style="border:3px #FFD382 dashed; width:105px">審核狀態</th>
                <th align="center" style="border:3px #FFD382 dashed; width:105px">廣告圖片</th>
                <th align="center" style="border:0px dashed; width:200px"></th>
              </tr>
            </thead>
            <tbody id="shipData">
              <tr align="center" valign="center">
                <td>1</td>
                <td>2</td>
                <td>2022-12-01</td>
                <td>
                  <div class="d-flex justify-content-center">
                    2023-01-01
                  </div>
                  <div class="d-none">
                    <input class="w-100" type="date" name="" id="">
                  </div>
                </td>
                <td>2024-01-31</td>
                <td>4000</td>
                <td>審核通過</td>
                <td id="inputFile" class="inputFile">

                </td>
                <td>
                  <div class="row">
                    <div class="col-12">
                      <input type="button" class="btn btn-light edit_btn d-inline-flex" value="編輯"
                        onclick="showButtonEvent()"
                        style="width: auto; padding:2px; border-radius: 8px; box-shadow: 3px 3px 1px #FFD382;">
                    </div>
                    <div class="col-12 d-block">
                      <button type="button" class="btn btn-light d-inline-flex" onclick="showButtonEvent()"
                        style="width: auto; padding:2px; border-radius: 8px; box-shadow: 3px 3px 1px #FFD382;">確認修改</button>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>

    <tbody id="reserve">
    </tbody>
    </table>
    </div>

    </div>
    </div>
    </div>
  </section>

  <!-- Class Section End -->

  <!-- Footer Section Begin -->
  <footer class="footer set-bg" data-setbg="img/footer_bg.jpg">
    <!-- <button type="button" id="BackTop"></button> -->
    <div class="mask">
      <div class="container">
        <div class="row">
          <div class="col-lg-3 col-md-3 col-sm-3">
            <div class="footer__member">
              <h6>會員專區</h6>
              <div class="footer__social">
                <a href="#">登入會員<i></i></a>
                <a href="#">訂位管理<i></i></a>
                <br />
                <a href="#">加入會員<i></i></a>
                <a href="#">定位管理<i></i></a>
                <br />
                <a href="#">優惠券<i></i></a>
                <a href="#">我的評論<i></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-3">
            <div class="footer__restaurant">
              <h6>餐廳</h6>
              <div class="footer__social">
                <a href="#">訂位<i></i></a>
                <br />
                <a href="#">購物車<i></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-3">
            <div class="footer__shopping">
              <h6>線上商城</h6>
              <div class="footer__social">
                <a href="#">商品搜尋<i></i></a>
                <br />
                <a href="#">購物車<i></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-3">
            <div class="footer__aboutus">
              <h6>關於我們</h6>
              <div class="footer__social">
                <a href="#">網站介紹<i></i></a>
                <br />
                <a href="#">履歷<i></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-9 col-sm-12">
            <div class="footer__widget">
              <h6>好食光</h6>
              <ul>
                <li>指導老師：</li>
                <li>吳永志老師 | 吳冠宏老師</li>
                <li>張互賓老師 | 郭惠民老師</li>
                <li>陳怡榕老師 | 馬全德老師</li>
                <li>組員 :</li>
                <li>陳宜瀅 | 張家銘 | 楊婕妤</li>
                <li>游育碩 | 黃郁婕 | 李佳欣 | 余可凡</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="copyright">
      <div class="container">
        <div class="row">
          <div class="col-lg-7">
            <p class="copyright__text text-white">
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              Copyright &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              All rights reserved | This template is made with
              <i class="fa fa-heart" aria-hidden="true"></i> by
              <a href="https://colorlib.com" target="_blank">Colorlib</a>
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
          </div>
          <div class="col-lg-5">
            <div class="copyright__widget">
              <ul>
                <li><a href="#">Privacy Policy</a></li>
                <li><a href="#">Terms & Conditions</a></li>
                <li><a href="#">Site Map</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- Footer Section End -->

  <!-- Search Begin -->
  <div class="search-model">
    <div class="h-100 d-flex align-items-center justify-content-center">
      <div class="search-close-switch">+</div>
      <form class="search-model-form">
        <input type="text" id="search-input" placeholder="Search here....." />
      </form>
    </div>
  </div>
  <!-- Search End -->

  <!-- Js Plugins -->
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.nice-select.min.js"></script>
  <script src="js/jquery.barfiller.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/jquery.slicknav.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.nicescroll.min.js"></script>
  <script src="js/main.js"></script>
  <!-- <script src="js/reservation.js"></script> -->
  <!-- <script src="js/alice.js"></script> -->
  <script src="js/alice_admin2_membership_management_page.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>


  <script> // GET
    const URL = 'http://localhost:8080/adOrders/restaurantNo/4'
    let resData = [];
    // 抽換資料
    const template = (order_no, rest_no, orderTime, startTime, endTime, price, verified, pic) => {
      return `<tr align="center">
                <td id="orderNo${order_no}" >
                  <div class="d-flex justify-content-center">
                    ${order_no}
                  </div>
                  <div class="d-none">
                    <input class="w-100" type="date" name="" id="">
                  </div>
                </td>
                <td>${rest_no}</td>
                <td>${orderTime}</td>
                <td id="startTime${order_no}" >
                  <div class="d-flex justify-content-center">
                    ${startTime}
                  </div>
                  <div class="d-none">
                    <input class="w-100" type="date" name="" id="startDate${order_no}">
                  </div>
                </td>
                <td id="endTime${order_no}" >
                  <div class="d-flex justify-content-center">
                    ${endTime}
                  </div>
                  <div class="d-none">
                    <input class="w-100" type="date" name="" id="endDate${order_no}" value="" disabled>
                  </div>
                </td>
                <td  id="price${order_no}" >${price}</td>
                <td id="verified${order_no}" >
                  <div class="d-flex justify-content-center">${!!verified ? '審核通過' : '尚未審核'}</div>
                  <div class="d-none">
                    <input class="w-100" type="date" name="" id="" disabled>
                  </div>
                </td>
                <td id="pic${order_no}">
                  <div id="preview_div${order_no}">
                    <img src="data:image/*;base64,${pic}" alt="">
                  </div>
                  <div>
                      <input id="input_pic${order_no}" type="file" style="display:none">
                  </div>
                </td>
                <td >
                  <div class="row">
                    <div class="col-12">
                      <input type="button" id="btnEdit${order_no}" class="btn btn-light edit_btn d-inline-flex" value="編輯" onclick="showButtonEvent()"
                        style="width: auto; padding:2px; border-radius: 8px; box-shadow: 3px 3px 1px #FFD382;">
                    </div>
                    <div class="col-12 d-block">
                      <button id="btnDelete${order_no}" type="button" class="btn btn-light d-none" onclick="deleteOrder()"
                      style="width: auto; padding:2px; border-radius: 8px; box-shadow: 3px 3px 1px #111111;">刪除</button>
                    </div>
                  </div>
                </td>
              </tr>`
    }



    const init = async () => {
      // table
      const shipData = document.querySelector('#shipData')
      // GET
      await fetch(URL).then((r) => r.json()).then((data) => {
        resData = data
        shipData.innerHTML = data.map(({
          adOrderNo,
          restaurantNo,
          adOrderTime,
          adStartTime,
          adEndTime,
          adOrderPrice,
          verified,
          slideshowPic
        }) => template(adOrderNo,
          restaurantNo,
          adOrderTime,
          adStartTime,
          adEndTime,
          adOrderPrice,
          verified,
          slideshowPic)).join('')
      });

      // get all btn
      const onEdit = document.querySelectorAll('.edit_btn')
      onEdit.forEach((btn, index) => {
        btn.onclick = () => { // 點選編輯按鈕
          let { adOrderNo } = resData[index]

          // 點擊變更-> 編輯(顯示刪除)) or 確認(隱藏刪除))
          let edit_btn = document.querySelector(`#btnEdit${adOrderNo}`)
          edit_btn.value = edit_btn.value === '編輯' ? '確認' : '編輯';
          let delete_btn = document.querySelector(`#btnDelete${adOrderNo}`)
          delete_btn.className = edit_btn.value === '編輯' ? 'btn btn-light d-none' : 'btn btn-light d-flex';

          // 尚未審核 -> 允許顯示刪除按鈕
          // let btn = document.querySelector(`#btnDelete${adOrderNo}`)
          // let editClass = btn.className
          // // btn btn-light d-none
          // verify[0].innerHTML === '尚未審核' ? btn.className = 'btn btn-light d-flex' : btn.className = 'btn btn-light d-none'

          // 判斷是否可進行編輯、刪除
          let verify = document.querySelectorAll(`#verified${adOrderNo} > div`)

          // 編輯開始 & 結束日期
          let startTime = document.querySelectorAll(`#startTime${adOrderNo} > div`)
          let endTime = document.querySelectorAll(`#endTime${adOrderNo} > div`)
          let starter = document.getElementById(`startDate${adOrderNo}`);
          let backer = document.getElementById(`endDate${adOrderNo}`);
          let timeClass = startTime[1].className;
          let endTimeClass = endTime[1].className;
          if (verify[0].innerHTML === '尚未審核') {
            startTime[1].className = timeClass === 'd-none' ? 'd-flex' : 'd-none'
            endTime[1].className = endTimeClass === 'd-none' ? 'd-flex' : 'd-none'
            const original_start_date_str = document.querySelectorAll(`#startTime${adOrderNo} > div`)[0].innerText.slice(0, 10);
            document.getElementById(`startDate${adOrderNo}`).setAttribute('value', original_start_date_str);
            const original_end_date_str = document.querySelectorAll(`#endTime${adOrderNo} > div`)[0].innerText.slice(0, 10);
            document.getElementById(`endDate${adOrderNo}`).setAttribute('value', original_end_date_str);
          } else {
            alert('已審核通過，無法修改訂單')
            edit_btn.value = '編輯';
            delete_btn.className = 'btn btn-light d-none';
          }



          // 自動設定結束時間

          let purchase = parseInt(document.getElementById(`price${adOrderNo}`).innerText) / 1000 // 1 = 7天、2 = 30天、3 = 90天、4 = 365天
          const changeDate = () => {
            // console.log(starter.value.toString())
            let year = parseInt(starter.value.toString().slice(0, 4));
            let month = parseInt(starter.value.toString().slice(5, 7));
            let date = parseInt(starter.value.toString().slice(8, 10));
            // 別打開QQ
            switch (purchase) {
              case 1:
                if (month == 12) {
                  if (date > 24) {
                    let year_str = (year + 1).toString();
                    let month_str = (month + 1 - 12).toString();
                    let date_str = (date + 7 - 31).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-' + date_str;

                  }
                } else if (month == 11) {
                  if (date > 23) {
                    let year_str = year.toString();
                    let month_str = (month + 1).toString();
                    let date_str = (date + 7 - 30).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-' + date_str;

                  }
                } else if (month == 10) {
                  if (date > 24) {
                    let year_str = year.toString();
                    let month_str = (month + 1).toString();
                    let date_str = (date + 7 - 31).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-' + month_str + '-' + date_str;

                  }
                } else if (month == 9) {
                  if (date > 23) {
                    let year_str = year.toString();
                    let month_str = (month + 1).toString();
                    let date_str = (date + 7 - 31).toString();
                    backer.value = year_str + '-' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-' + date_str;

                  }
                } else if (month == 2) {
                  if (year % 4 == 0) { //閏年
                    if (date > 21) {
                      let year_str = year.toString();
                      let month_str = (month + 1).toString();
                      let date_str = (date + 7 - 28).toString();
                      backer.value = year_str + '-0' + month_str + '-0' + date_str;

                    } else if (date < 3) {
                      let year_str = year.toString();
                      let month_str = month.toString();
                      let date_str = (date + 7).toString();
                      backer.value = year_str + '-0' + month_str + '-0' + date_str;

                    } else {
                      let year_str = year.toString();
                      let month_str = month.toString();
                      let date_str = (date + 7).toString();
                      backer.value = year_str + '-0' + month_str + '-' + date_str;

                    }
                  } else {
                    if (date > 21) {
                      let year_str = year.toString();
                      let month_str = (month + 1).toString();
                      let date_str = (date + 7 - 27).toString();
                      backer.value = year_str + '-0' + month_str + '-0' + date_str;

                    } else if (date < 3) {
                      let year_str = year.toString();
                      let month_str = month.toString();
                      let date_str = (date + 7).toString();
                      backer.value = year_str + '-0' + month_str + '-0' + date_str;

                    } else {
                      let year_str = year.toString();
                      let month_str = month.toString();
                      let date_str = (date + 7).toString();
                      backer.value = year_str + '-0' + month_str + '-' + date_str;

                    }
                  }
                } else if (month == 1 || month == 3 || month == 5 || month == 7 || month == 8) {
                  if (date > 24) {
                    let year_str = year.toString();
                    let month_str = (month + 1).toString();
                    let date_str = (date + 7 - 31).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-' + date_str;

                  }
                } else {
                  if (date > 23) {
                    let year_str = year.toString();
                    let month_str = (month + 1).toString();
                    let date_str = (date + 7 - 30).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else if (date < 3) {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-0' + date_str;

                  } else {
                    let year_str = year.toString();
                    let month_str = month.toString();
                    let date_str = (date + 7).toString();
                    backer.value = year_str + '-0' + month_str + '-' + date_str;

                  }
                }
                break;
              case 2:
                if (date < 10) {
                  if (month == 12) {
                    let year2_str = (year + 1).toString();
                    let month2_str = (month + 1 - 12).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-0' + month2_str + '-0' + date2_str;

                  } else if (month == 1) {
                    let year2_str = year.toString();
                    let month2_str = (month + 1).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-0' + month2_str + '-0' + date2_str;

                  } else if (month < 9 && month > 1) {
                    let year2_str = year.toString();
                    let month2_str = (month + 1).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-0' + month2_str + '-0' + date2_str;

                  } else {
                    let year2_str = year.toString();
                    let month2_str = (month + 1).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-' + month2_str + '-0' + date2_str;

                  }
                } else {
                  if (month == 12) {
                    let year2_str = (year + 1).toString();
                    let month2_str = (month + 1 - 12).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-0' + month2_str + '-' + date2_str;

                  } else if (month == 1) {
                    if (year % 4 == 0) {
                      if (date > 28) {
                        let year2_str = year.toString();
                        let month2_str = (month + 2).toString();
                        let date2_str = (date - 28).toString();
                        backer.value = year2_str + '-0' + month2_str + '-0' + date2_str;

                      } else {
                        let year2_str = year.toString();
                        let month2_str = (month + 2).toString();
                        let date2_str = (date).toString();
                        backer.value = year2_str + '-0' + month2_str + '-' + date2_str;

                      }
                    } else {
                      if (date > 27) {
                        let year2_str = year.toString();
                        let month2_str = (month + 2).toString();
                        let date2_str = (date - 27).toString();
                        backer.value = year2_str + '-0' + month2_str + '-0' + date2_str;

                      } else {
                        let year2_str = year.toString();
                        let month2_str = (month + 2).toString();
                        let date2_str = (date).toString();
                        backer.value = year2_str + '-0' + month2_str + '-' + date2_str;

                      }
                    }
                  } else if (month < 9) {
                    let year2_str = year.toString();
                    let month2_str = (month + 1).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-0' + month2_str + '-' + date2_str;

                  } else {
                    let year2_str = year.toString();
                    let month2_str = (month + 1).toString();
                    let date2_str = date.toString();
                    backer.value = year2_str + '-' + month2_str + '-' + date2_str;
                  }
                }
                break;
              case 3:
                if (month == 2 || month == 4 || month == 5 || month == 6 || month == 7) {
                  if (date < 10) {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-0' + date3_str;
                  } else {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                  }
                } else if (month == 1 || month == 3 || month == 8) {
                  if (date < 10) {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-0' + date3_str;
                  } else if (date < 31) {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                  } else {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = '30';
                    backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                  }
                } else if (month == 9) {
                  if (date < 10) {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-' + month3_str + '-0' + date3_str;
                  } else {
                    let year3_str = (year).toString();
                    let month3_str = (month + 3).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-' + month3_str + '-' + date3_str;
                  }
                } else if (month == 11) {
                  if (date < 10) {
                    let year3_str = (year + 1).toString();
                    let month3_str = (month + 3 - 12).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-0' + date3_str;
                  } else if (date < 28) {
                    let year3_str = (year + 1).toString();
                    let month3_str = (month + 3 - 12).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                  } else {
                    if (year % 4 == 0) {
                      let year3_str = (year + 1).toString();
                      let month3_str = (month + 3 - 12).toString();
                      let date3_str = '28';
                      backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                    } else {
                      let year3_str = (year + 1).toString();
                      let month3_str = (month + 3 - 12).toString();
                      let date3_str = '27';
                      backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                    }
                  }
                } else if (month == 10 || month == 12) {
                  if (date < 10) {
                    let year3_str = (year + 1).toString();
                    let month3_str = (month + 3 - 12).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-0' + date3_str;
                  } else {
                    let year3_str = (year + 1).toString();
                    let month3_str = (month + 3 - 12).toString();
                    let date3_str = date.toString();
                    backer.value = year3_str + '-0' + month3_str + '-' + date3_str;
                  }
                }
                break;
              case 4:
                // 考慮日期加0
                // 考慮月份加上0
                let add_bar_and_zero = '-0';
                let add_bar = '-';
                if (year % 4 == 0) {
                  if (month == 2) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar_and_zero + date4_str;

                    } else if (month < 28) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar + date4_str;

                    } else {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = '27';
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar + date4_str;

                    }
                  } else if (month == 1 || month == 3 || month == 4 || month == 5 || month == 6 || month == 7 || month == 8 || month == 9) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar_and_zero + date4_str;

                    } else {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar + date4_str;

                    }
                  } else if (month == 10 || month == 11 || month == 12) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar + month4_str + add_bar_and_zero + date4_str;

                    } else {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar + month4_str + add_bar + date4_str;

                    }
                  }
                } else {
                  if (month == 2) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar_and_zero + date4_str;

                    } else if (month < 28) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar + date4_str;

                    }
                  } else if (month == 1 || month == 3 || month == 4 || month == 5 || month == 6 || month == 7 || month == 8 || month == 9) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar_and_zero + date4_str;

                    } else {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar_and_zero + month4_str + add_bar + date4_str;

                    }
                  } else if (month == 10 || month == 11 || month == 12) {
                    if (date < 10) {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar + month4_str + add_bar_and_zero + date4_str;

                    } else {
                      let year4_str = (year + 1).toString();
                      let month4_str = month.toString();
                      let date4_str = date.toString();
                      backer.value = year4_str + add_bar + month4_str + add_bar + date4_str;

                    }

                  }
                }
                break;
            }
          }
          starter.onchange = changeDate;


          // PUT
          // api
          const URL_PUT = 'http://localhost:8080/adOrders';
          if (edit_btn.value === '確認') {
            edit_btn.onclick = () => {
              // get edit data
              const startDateForPOST = (starter.value + ' 00:00:00');
              const endDateForPOST = (backer.value + ' 00:00:00');
              const editItem = parseInt(document.querySelectorAll(`#orderNo${adOrderNo} > div`)[0].innerHTML.trim());
              // const edit_startTime = document.querySelector
              const base64_str = document.querySelector(`#pic${adOrderNo}>div>img`).getAttribute('src');
              const base64 = base64_str.slice(base64_str.indexOf(",") + 1).replace("[", "");
              if (startDateForPOST != ' 00:00:00' && endDateForPOST != ' 00:00:00' && base64 != null) {
                if (confirm('確定修改訂單?')) {
                  // alert('已成功修改訂單。')
                  swal({
                    title: "",
                    text: "已成功修改訂單",
                    icon: "success",
                    button: "OK",
                  });
                  const editOrder = endpoint => {
                    fetch(`${URL_PUT}/${endpoint}`, {
                      method: 'PUT',
                      headers: { 'Content-type': 'application/json' },
                      body: JSON.stringify({
                        adOrderNo: editItem,
                        restaurantNo: 4,
                        adStartTime: startDateForPOST,
                        adEndTime: endDateForPOST,
                        adOrderPrice: parseInt(document.getElementById(`price${adOrderNo}`).innerText),
                        slideshowPicBase64: [base64]
                        // slideshowPicBase64: [document.querySelector(`#pic${adOrderNo}>img`).getAttribute('src').slice(20).replace("[", "")]
                      })
                    }).then((r) => r.json()).then((data) => {
                      console.log(data); setTimeout(function () {
                        location.reload();
                      }, 1500);
                    })
                  }
                  editOrder(editItem);

                } else {
                  swal("已取消修改訂單。", "", "info");
                  setTimeout(function () {
                    location.reload();
                  }, 1500);
                }
              } else {
                alert('資料未正確被修改，請再次確認或取消修改訂單。')
                location.reload();
              }
            }
          }


          // 更換圖片
          let newImg = document.querySelector(`#pic${adOrderNo}`);
          var preview_div = document.querySelector(`#preview_div${adOrderNo}`);
          var preview_div_img = document.querySelector(`#preview_div${adOrderNo}>img`);
          var input_btn = document.querySelector(`#input_pic${adOrderNo}`);
          async function changeImage() {
            // if no pic exists
            if (verify[0].innerHTML === '尚未審核') {
              newImg.setAttribute("style", "background-color:#FFD382");
              newImg.onclick = preview;
            }
            // }

          }

          async function preview() {
            console.log('preview')
            input_btn.click();
          }
          input_btn.addEventListener("change", function (e) {
            console.log('preview2')
            const inputTarget = e.target;
            const file = inputTarget.files[0];

            if (file) {
              const reader = new FileReader();
              console.log('preview3')
              reader.addEventListener("load", function (e) {
                const readerTarget = e.target;

                const img = document.createElement("img");
                img.src = readerTarget.result;
                img.classList.add(`picture__img${adOrderNo}`);

                preview_div.innerHTML = "";
                preview_div.appendChild(img);
              });
              reader.readAsDataURL(file);
            } else {
              preview_div.innerHTML = '選擇圖片';
            }
          });
          changeImage();



          // 顯示審核狀態 -> 管理員身分才能操作
          // let verify = document.querySelectorAll(`#verified${adOrderNo} > div`)
          // let verifyClass = verify[1].className;
          // verify[1].className = verifyClass === 'd-none' ? 'd-flex' : 'd-none'

          // DELETE
          //尚未審核前 -> 刪除訂單
          let deleteItem = document.querySelectorAll(`#orderNo${adOrderNo} > div`)[0].innerHTML.trim()
          console.log(deleteItem)
          deleteOrder = () => {
            if (confirm('確定要刪除訂單?')) {
              swal("已成功刪除訂單。", "", "warning");
              setTimeout(function () {
                location.reload();
              }, 1500);
              deleteData(deleteItem);
              // location.reload();
            } else {
              alert('已取消刪除訂單。')
              location.reload();
            }
          }
          const URL3 = "http://localhost:8080/adOrders"; // {adOrderNo}
          const deleteData = endpoint => {
            fetch(`${URL3}/${endpoint}`, {
              method: 'DELETE'
            })
              .then(response => response.json())
              .then(data => console.log(data), setTimeout(function () {
                location.reload();
              }, 1500));
          }
        }

      })
    }

    window.onload = init

    // ****************************************************************************************************

    // // POST
    // const URL_POST = 'http://localhost:8080/adOrders';
    // const img = document.querySelector("#picture__input");
    // const submit_btn = document.querySelector("#submit_btn");

    // img.onchange = (e) => {
    //   let ad_start = (document.querySelector("#ad_start").value + ' 00:00:00');
    //   let ad_end = (document.querySelector("#ad_end").value + ' 00:00:00');
    //   let total_ad_amount = parseInt(document.querySelector("#total_ad_amount").value);

    //   let read = new FileReader();
    //   read.readAsDataURL(e.target.files[0]); // e.target.files是fileList
    //   read.onload = (data) => {
    //     let base64 = data.target.result.slice(23).replace("[", "");
    //     fetch(URL_POST, {
    //       method: "POST",
    //       headers: { 'Content-type': 'application/json', },
    //       body: JSON.stringify({
    //         restaurantNo: 4,
    //         adStartTime: ad_start,
    //         adEndTime: ad_end,
    //         adOrderPrice: total_ad_amount,
    //         slideshowPicBase64: [base64]
    //       }),
    //     })
    //       .then((r) => r.json()) // 接收到回傳的物件，再用 .json() analyze資料
    //       .then((data) => { console.log(data) })
    //   }
    //   alert('送交訂單成功');
    // }
    // ****************************************************************************************************
  </script>
</body>

</html>